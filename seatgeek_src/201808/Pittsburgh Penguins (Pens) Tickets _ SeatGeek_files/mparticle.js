//
//  Copyright 2017 mParticle, Inc.
//
//  Licensed under the Apache License, Version 2.0 (the "License");
//  you may not use this file except in compliance with the License.
//  You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
//  Unless required by applicable law or agreed to in writing, software
//  distributed under the License is distributed on an "AS IS" BASIS,
//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
//  See the License for the specific language governing permissions and
//  limitations under the License.
//
//  Uses portions of code from jQuery
//  jQuery v1.10.2 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license

window.mParticle = window.mParticle || {};
window.mParticle.config = window.mParticle.config || {};
window.mParticle.config.serviceUrl = 'jssdk.mparticle.com/v1/JS/';
window.mParticle.config.secureServiceUrl = 'jssdks.mparticle.com/v1/JS/';
window.mParticle.config.appName = "SeatGeek Desktop";
(function(n){function lt(){var e,f,r,i,o,s,t=arguments[0]||{},u=1,c=arguments.length,h=!1,n={hasOwn:Object.prototype.hasOwnProperty,class2type:{},type:function(t){return t==null?String(t):n.class2type[Object.prototype.toString.call(t)]||"object"},isPlainObject:function(t){if(!t||n.type(t)!=="object"||t.nodeType||n.isWindow(t))return!1;try{if(t.constructor&&!n.hasOwn.call(t,"constructor")&&!n.hasOwn.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}for(var i in t);return i===undefined||n.hasOwn.call(t,i)},isArray:Array.isArray||function(t){return n.type(t)==="array"},isFunction:function(t){return n.type(t)==="function"},isWindow:function(n){return n!=null&&n==n.window}};for(typeof t=="boolean"&&(h=t,t=arguments[1]||{},u=2),typeof t=="object"||n.isFunction(t)||(t={}),c===u&&(t=this,--u);u<c;u++)if((e=arguments[u])!=null)for(f in e)(r=t[f],i=e[f],t!==i)&&(h&&i&&(n.isPlainObject(i)||(o=n.isArray(i)))?(o?(o=!1,s=r&&n.isArray(r)?r:[]):s=r&&n.isPlainObject(r)?r:{},t[f]=lt(h,s,i)):i!==undefined&&(t[f]=i));return t}function ar(i){var r;try{r=new n.XMLHttpRequest}catch(u){t("Error creating XMLHttpRequest object.")}if(r&&i&&"withCredentials"in r)r.onreadystatechange=i;else if(typeof n.XDomainRequest!="undefined"){t("Creating XDomainRequest object");try{r=new n.XDomainRequest;r.onload=i}catch(u){t("Error creating XDomainRequest object")}}return r}function vr(){return i.forceHttps?"https://"+di+yt:ou+(n.location.protocol==="https:"?di:or)+yt}function ri(n,t){var i=0,r;if(Array.prototype.indexOf)return n.indexOf(t,0)>=0;for(r=n.length;i<r;i++)if(i in n&&n[i]===t)return!0}function k(r,u){if(!i.useNativeSdk)return!1;if(n.mParticleAndroid&&n.mParticleAndroid.hasOwnProperty(r))return t(h.SendAndroid+r),n.mParticleAndroid[r](u),!0;if(n.mParticle.isIOS){t(h.SendIOS+r);var f=document.createElement("IFRAME");return f.setAttribute("src","mp-sdk://"+r+"/"+u),document.documentElement.appendChild(f),f.parentNode.removeChild(f),f=null,!0}return!1}function pt(){return i.useNativeSdk?n.mParticleAndroid||n.mParticle.isIOS?!0:!1:!1}function pi(n){var i,r=function(){i.readyState===4&&(t("Received "+i.statusText+" from server"),pu(i.responseText))};if(t(h.SendBegin),!n){t(p.EventEmpty);return}if(!k(d.LogEvent,JSON.stringify(n))&&(t(h.SendHttp),i=ar(r),i))try{i.open("post",vr()+"/Events");i.send(JSON.stringify(ku(n)));n.EventName!==e.AppStateTransition&&vu(n)}catch(u){t("Error sending event to mParticle servers. "+u)}}function au(n,i){var r,u;if(n&&n.isVisible&&(r=ar(),u=JSON.stringify({mid:n.id,n:i.EventName,attrs:i.EventAttributes,sdk:i.SDKVersion,dt:i.EventDataType,et:i.EventCategory,dbg:i.Debug,ct:i.Timestamp,eec:i.ExpandedEventCount}),r))try{r.open("post",vr()+"/Forwarding");r.send(u)}catch(f){t("Error sending forwarding stats to mParticle servers.")}}function ir(n,i){f.length&&f.forEach(function(r){var f=r[n],u;if(f)try{u=r[n](i);u&&t(u)}catch(e){t(e)}})}function vu(n){var r,u,h,p=function(n,t){var r,i;if(n.UserAttributes)for(i in n.UserAttributes)n.UserAttributes.hasOwnProperty(i)&&(r=ot(i),ri(t,r)&&delete n.UserAttributes[i])},w=function(n,t){var r,u,f=!1,i;try{if(n.UserAttributes&&rt(n.UserAttributes)&&Object.keys(n.UserAttributes).length&&t&&rt(t)&&Object.keys(t).length)for(i in n.UserAttributes)if(n.UserAttributes.hasOwnProperty(i)&&(r=ot(i),u=ot(n.UserAttributes[i]),r===t.userAttributeName&&u===t.userAttributeValue)){f=!0;break}return f?t.includeOnMatch?!0:!1:t.includeOnMatch?!1:!0}catch(e){return!0}},b=function(n,t){n.UserIdentities&&n.UserIdentities.length&&n.UserIdentities.forEach(function(i,r){ri(t,i.Type)&&(n.UserIdentities.splice(r,1),r>0&&r--)})},v=function(n,t){var r,i;if(t)for(i in n.EventAttributes)n.EventAttributes.hasOwnProperty(i)&&(r=ot(n.EventCategory+n.EventName+i),ri(t,r)&&delete n.EventAttributes[i])},o=function(n,t){return n&&n.length&&ri(n,t)?!0:!1},k=[e.PageEvent,e.PageView,e.Commerce],i,s,c,l,y,a;if(!pt()&&f)for(u=ot(n.EventCategory+n.EventName),h=ot(n.EventCategory),i=0;i<f.length;i++){if(k.indexOf(n.EventDataType)>-1&&f[i].filteringEventAttributeValue&&f[i].filteringEventAttributeValue.eventAttributeName&&f[i].filteringEventAttributeValue.eventAttributeValue){if(s=null,n.EventAttributes)for(c in n.EventAttributes){u=ot(c);u===f[i].filteringEventAttributeValue.eventAttributeName&&(s={name:u,value:ot(n.EventAttributes[c])});break}if(l=s!==null&&s.value===f[i].filteringEventAttributeValue.eventAttributeValue,y=f[i].filteringEventAttributeValue.includeOnMatch===!0?l:!l,!y)continue}if(r={},r=lt(!0,r,n),n.EventDataType===e.PageEvent&&(o(f[i].eventNameFilters,u)||o(f[i].eventTypeFilters,h)))continue;else if(n.EventDataType===e.Commerce&&o(f[i].eventTypeFilters,h))continue;else if(n.EventDataType===e.PageView&&o(f[i].screenNameFilters,u))continue;if(r.EventAttributes&&(n.EventDataType===e.PageEvent?v(r,f[i].attributeFilters):n.EventDataType===e.PageView&&v(r,f[i].pageViewAttributeFilters)),b(r,f[i].userIdentityFilters),p(r,f[i].userAttributeFilters),f[i].filteringUserAttributeValue&&Object.keys(f[i].filteringUserAttributeValue).length&&!w(r,f[i].filteringUserAttributeValue))break;t("Sending message to forwarder: "+f[i].name);a=f[i].process(r);a&&t(a)}}function yu(){!pt()&&f&&(f.sort(function(n,t){return n.settings.PriorityValue=n.settings.PriorityValue||0,t.settings.PriorityValue=t.settings.PriorityValue||0,-1*(n.settings.PriorityValue-t.settings.PriorityValue)}),f.forEach(function(n){n.init(n.settings,au,!1,null,s,w,dt,li,cr,ci)}))}function pu(n){var o=new Date,i,e=null,r,f;if(n)try{if(t("Parsing response from server"),i=JSON.parse(n),!hi&&ni&&(e=ni),ni=i.mpid?i.mpid:null,vt.attemptCookieSync(e,ni),i&&i.Store){t("Parsed store from response, updating local settings");ut={};for(r in i.Store)r==="uid"&&i.Store.hasOwnProperty(r)&&(f=i.Store[r],!f.Value||new Date(f.Expires)<o?ut.hasOwnProperty(r)&&delete ut[r]:ut[r]=f);u.update()}}catch(s){t("Error parsing JSON response from server: "+s.name)}}function wu(){yi||"geolocation"in navigator&&(hr=navigator.geolocation.watchPosition(function(n){vi={lat:n.coords.latitude,lng:n.coords.longitude}}),yi=!0)}function yr(){yi&&(navigator.geolocation.clearWatch(hr),vi=null,yi=!1)}function bu(n,t){var r=[],i;t.flags={};for(i in n.CustomFlags)r=[],n.CustomFlags.hasOwnProperty(i)&&(Array.isArray(n.CustomFlags[i])?n.CustomFlags[i].forEach(function(n){(typeof n=="number"||typeof n=="string"||typeof n=="boolean")&&r.push(n.toString())}):(typeof n.CustomFlags[i]=="number"||typeof n.CustomFlags[i]=="string"||typeof n.CustomFlags[i]=="boolean")&&r.push(n.CustomFlags[i].toString()),r.length&&(t.flags[i]=r))}function ku(i){var u,r;return i.UserIdentities.length&&(u=i.UserIdentities.map(function(n){if(st.isValid(n.Type))return n;t("IdentityType is not valid. Please ensure you are using a valid IdentityType from http://docs.mparticle.com/#user-identity")})),r={n:i.EventName,et:i.EventCategory,ua:i.UserAttributes,ui:u,str:i.Store,attrs:i.EventAttributes,sdk:i.SDKVersion,sid:i.SessionId,sl:i.SessionLength,dt:i.EventDataType,dbg:i.Debug,ct:i.Timestamp,lc:i.Location,o:i.OptOut,eec:i.ExpandedEventCount,av:i.AppVersion,cgid:i.ClientGeneratedId,das:i.DeviceId},r.uic=oi,oi=!1,i.EventDataType===e.AppStateTransition&&(r.fr=hi,r.iu=!1,r.at=ie.AppInit,r.lr=n.location.href||null,r.attrs=null),i.CustomFlags&&bu(i,r),r.pb=du(),i.EventDataType===e.Commerce?(r.cu=tr,i.ShoppingCart&&(r.sc={pl:rr(i.ShoppingCart.ProductList)}),i.ProductAction?r.pd={an:i.ProductAction.ProductActionType,cs:at(i.ProductAction.CheckoutStep),co:i.ProductAction.CheckoutOptions,pl:rr(i.ProductAction.ProductList),ti:i.ProductAction.TransactionId,ta:i.ProductAction.Affiliation,tcc:i.ProductAction.CouponCode,tr:at(i.ProductAction.TotalAmount),ts:at(i.ProductAction.ShippingAmount),tt:at(i.ProductAction.TaxAmount)}:i.PromotionAction?r.pm={an:i.PromotionAction.PromotionActionType,pl:i.PromotionAction.PromotionList.map(function(n){return{id:n.Id,nm:n.Name,cr:n.Creative,ps:n.Position?n.Position:0}})}:i.ProductImpressions&&(r.pi=i.ProductImpressions.map(function(n){return{pil:n.ProductImpressionList,pl:rr(n.ProductList)}}))):i.EventDataType===e.Profile&&(r.pet=i.ProfileMessageType),r}function rr(n){return n?n.map(function(n){return pr(n)}):[]}function pr(n){return{id:ui(n.Sku),nm:ui(n.Name),pr:at(n.Price),qt:at(n.Quantity),br:ui(n.Brand),va:ui(n.Variant),ca:ui(n.Category),ps:at(n.Position),cc:ui(n.CouponCode),tpa:at(n.TotalAmount),attrs:n.Attributes}}function ui(n){return v.isStringOrNumber(n)?n:null}function at(n){if(isNaN(n)||!isFinite(n))return 0;var t=parseFloat(n);return isNaN(t)?0:t}function du(){var i={},n;for(var t in a)a.hasOwnProperty(t)&&(n=a[t].map(function(n){return pr(n)}),i[t]=pt()?{ProductList:n}:{pl:n});return i}function wr(n,t){t.TransactionId=n.Id;t.Affiliation=n.Affiliation;t.CouponCode=n.CouponCode;t.TotalAmount=n.Revenue;t.ShippingAmount=n.Shipping;t.TaxAmount=n.Tax}function wt(n,t,r,u,f){var o,h=n===e.OptOut?!bt:null;return(r=ai(r),y||n==e.OptOut)?(n!==e.SessionEnd&&(nt=new Date),o={EventName:t||n,EventCategory:u,UserAttributes:s,UserIdentities:w,Store:ut,EventAttributes:r,SDKVersion:sr,SessionId:y,EventDataType:n,Debug:i.isSandbox,Location:vi,OptOut:h,ProductBags:a,ExpandedEventCount:0,CustomFlags:f,AppVersion:dt,ClientGeneratedId:ci,DeviceId:kt},n===e.SessionEnd&&(o.SessionLength=nt.getTime()-ft.getTime(),o.EventAttributes=ct),o.Timestamp=nt.getTime(),o):null}function wi(n){switch(n){case r.AddToCart:return"AddToCart";case r.AddToWishlist:return"AddToWishlist";case r.Checkout:return"Checkout";case r.CheckoutOption:return"CheckoutOption";case r.Click:return"Click";case r.Purchase:return"Purchase";case r.Refund:return"Refund";case r.RemoveFromCart:return"RemoveFromCart";case r.RemoveFromWishlist:return"RemoveFromWishlist";case r.ViewDetail:return"ViewDetail";case r.Unknown:default:return"Unknown"}}function gu(n){switch(n){case g.PromotionClick:return"PromotionClick";case g.PromotionView:return"PromotionView";default:return"Unknown"}}function nf(n){switch(n){case r.AddToCart:return o.ProductAddToCart;case r.AddToWishlist:return o.ProductAddToWishlist;case r.Checkout:return o.ProductCheckout;case r.CheckoutOption:return o.ProductCheckoutOption;case r.Click:return o.ProductClick;case r.Purchase:return o.ProductPurchase;case r.Refund:return o.ProductRefund;case r.RemoveFromCart:return o.ProductRemoveFromCart;case r.RemoveFromWishlist:return o.ProductRemoveFromWishlist;case r.Unknown:return c.Unknown;case r.ViewDetail:return o.ProductViewDetail;default:return t("Could not convert product action type "+n+" to event type"),null}}function tf(n){switch(n){case g.PromotionClick:return o.PromotionClick;case g.PromotionView:return o.PromotionView;default:return t("Could not convert promotion action type "+n+" to event type"),null}}function rf(n){var t=[],u,i,o,f;return n.ProductAction?(u=!1,n.ProductAction.ProductActionType===r.Purchase||n.ProductAction.ProductActionType===r.Refund?(i=lt(!1,{},n.EventAttributes),i["Product Count"]=n.ProductAction.ProductList?n.ProductAction.ProductList.length:0,dr(i,n.ProductAction),n.CurrencyCode&&(i["Currency Code"]=n.CurrencyCode),o=wt(e.PageEvent,bi(r.getExpansionName(n.ProductAction.ProductActionType),!0),i,c.Transaction),t.push(o)):u=!0,f=n.ProductAction.ProductList,!f)?t:(f.forEach(function(i){var f=lt(!1,n.EventAttributes,i.Attributes),o;u?dr(f,n.ProductAction):kr(f,n.ProductAction);br(f,i);o=wt(e.PageEvent,bi(r.getExpansionName(n.ProductAction.ProductActionType)),f,c.Transaction);t.push(o)}),t):t}function br(n,t){t.CouponCode&&(n["Coupon Code"]=t.CouponCode);t.Brand&&(n.Brand=t.Brand);t.Category&&(n.Category=t.Category);t.Name&&(n.Name=t.Name);t.Sku&&(n.Id=t.Sku);t.Price&&(n["Item Price"]=t.Price);t.Quantity&&(n.Quantity=t.Quantity);t.Position&&(n.Position=t.Position);t.Variant&&(n.Variant=t.Variant);n["Total Product Amount"]=t.TotalAmount||0}function kr(n,t){t.TransactionId&&(n["Transaction Id"]=t.TransactionId)}function dr(n,t){kr(n,t);t.Affiliation&&(n.Affiliation=t.Affiliation);t.CouponCode&&(n["Coupon Code"]=t.CouponCode);t.TotalAmount&&(n["Total Amount"]=t.TotalAmount);t.ShippingAmount&&(n["Shipping Amount"]=t.ShippingAmount);t.TaxAmount&&(n["Tax Amount"]=t.TaxAmount);t.CheckoutOptions&&(n["Checkout Options"]=t.CheckoutOptions);t.CheckoutStep&&(n["Checkout Step"]=t.CheckoutStep)}function uf(n){var t=[],i;return n.PromotionAction?(i=n.PromotionAction.PromotionList,i.forEach(function(i){var r=lt(!1,{},n.EventAttributes),u;ff(r,i);u=wt(e.PageEvent,bi(g.getExpansionName(n.PromotionAction.PromotionActionType)),r,c.Transaction);t.push(u)}),t):t}function bi(n,t){return"eCommerce - "+n+" - "+(t?"Total":"Item")}function ff(n,t){t.Id&&(n.Id=t.Id);t.Creative&&(n.Creative=t.Creative);t.Name&&(n.Name=t.Name);t.Position&&(n.Position=t.Position)}function ef(n){var t=[];return n.ProductImpressions?(n.ProductImpressions.forEach(function(i){i.ProductList&&i.ProductList.forEach(function(r){var u=lt(!1,{},n.EventAttributes),f,o;if(r.Attributes)for(f in r.Attributes)u[f]=r.Attributes[f];br(u,r);i.ProductImpressionList&&(u["Product Impression List"]=i.ProductImpressionList);o=wt(e.PageEvent,bi("Impression"),u,c.Transaction);t.push(o)})}),t):t}function of(n){return n?rf(n).concat(uf(n)).concat(ef(n)):null}function fi(){var n;return(t(h.StartingLogCommerceEvent),tt())?(n=wt(e.Commerce),n.EventName="eCommerce - ",n.CurrencyCode=tr,n.ShoppingCart={ProductList:b},n):(t(h.AbandonLogEvent),null)}function sf(n,t,i){var u=fi();u&&(u.EventName+=wi(r.Checkout),u.EventCategory=o.ProductCheckout,u.ProductAction={ProductActionType:r.Checkout,CheckoutStep:n,CheckoutOptions:t,ProductList:u.ShoppingCart.ProductList},ei(u,i))}function ur(n,t,i){var r=fi();r&&(r.EventCategory=nf(n),r.EventName+=wi(n),r.ProductAction={ProductActionType:n,ProductList:Array.isArray(t)?t:[t]},ei(r,i))}function hf(n,t,i){var u=fi();u&&(u.EventName+=wi(r.Purchase),u.EventCategory=o.ProductPurchase,u.ProductAction={ProductActionType:r.Purchase},u.ProductAction.ProductList=gr(u,t),wr(n,u.ProductAction),ei(u,i))}function cf(n,i,u){if(!n){t(p.TransactionRequired);return}var f=fi();f&&(f.EventName+=wi(r.Refund),f.EventCategory=o.ProductRefund,f.ProductAction={ProductActionType:r.Refund},f.ProductAction.ProductList=gr(f,i),wr(n,f.ProductAction),ei(f,u))}function gr(n,t){return t?Array.isArray(t)?t:[t]:n.ShoppingCart.ProductList}function lf(n,t,i){var r=fi();r&&(r.EventName+=gu(n),r.EventCategory=tf(n),r.PromotionAction={PromotionActionType:n,PromotionList:[t]},ei(r,i))}function af(n,t){var i=fi();i&&(i.EventName+="Impression",i.EventCategory=o.ProductImpression,Array.isArray(n)||(n=[n]),i.ProductImpressions=[],n.forEach(function(n){i.ProductImpressions.push({ProductImpressionList:n.Name,ProductList:Array.isArray(n.Product)?n.Product:[n.Product]})}),ei(i,t))}function nu(){var n=u.getCookie()||u.getLocalStorage();!y&&n&&(n.sid?y=n.sid:i.startNewSession())}function vf(){t(h.StartingLogOptOut);pi(wt(e.OptOut,null,null,c.Other))}function yf(){et(e.AppStateTransition)}function et(n,i,r,f,e){t(h.StartingLogEvent+": "+i);tt()?(nu(),r&&(r=ai(r)),pi(wt(n,i,r,f,e)),u.update()):t(h.AbandonLogEvent)}function ei(n,i){t(h.StartingLogCommerceEvent);i=ai(i);tt()?(nu(),pt()&&(n.ShoppingCart={},n.ProductBags={}),i&&(n.EventAttributes=i),pi(n),u.update()):t(h.AbandonLogEvent)}function pf(){var n;if(t(h.StartingLogEvent+": logOut"),tt())return n=wt(e.Profile),n.ProfileMessageType=te.Logout,pi(n),u.update(),n;t(h.AbandonLogEvent)}function tu(n){return decodeURIComponent(n.replace(su," "))}function iu(n){return n.indexOf('"')===0&&(n=n.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")),n}function wf(t){return n.crypto&&n.crypto.getRandomValues?(t^n.crypto.getRandomValues(new Uint8Array(1))[0]%16>>t/4).toString(16):(t^Math.random()*16>>t/4).toString(16)}function gt(n){return n?wf(n):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,gt)}function t(t){i.isDebug&&n.console&&n.console.log&&n.console.log(t)}function bf(n){for(var t in c)if(c.hasOwnProperty(t)&&c[t]===n)return!0;return!1}function fr(n){t(h.LoadingConfig);for(var i in ht)ht.hasOwnProperty(i)&&(l[i]=ht[i]),n.hasOwnProperty(i)&&(l[i]=n[i])}function tt(){return bt&&(yt||pt())?!0:!1}function rt(n){var t=Object.prototype.toString.call(n);return t==="[object Object]"||t==="[object Error]"}function ru(i,r,u,f,o){var h=[],v=function(i){var r=function(){s.href?n.location.href=s.href:s.submit&&s.submit()};t("DOM event triggered, handling event");et(e.PageEvent,typeof u=="function"?u(s):u,typeof f=="function"?f(s):f,o||c.Other);(s.href&&s.target!=="_blank"||s.submit)&&(i.preventDefault?i.preventDefault():i.returnValue=!1,setTimeout(r,l.Timeout))},s,a;if(!r){t("Can't bind event, selector is required");return}if(typeof r=="string"?h=document.querySelectorAll(r):r.nodeType&&(h=[r]),h.length)for(t("Found "+h.length+" element"+(h.length>1?"s":"")+", attaching event handlers"),a=0;a<h.length;a++)s=h[a],s.addEventListener?s.addEventListener(i,v,!1):s.attachEvent?s.attachEvent("on"+i,v):s["on"+i]=v;else t("No elements found")}function ot(n){var t=0,i=0,r;if(!n)return null;if(n=n.toString().toLowerCase(),Array.prototype.reduce)return n.split("").reduce(function(n,t){return n=(n<<5)-n+t.charCodeAt(0),n&n},0);if(n.length===0)return t;for(i=0;i<n.length;i++)r=n.charCodeAt(i),t=(t<<5)-t+r,t=t&t;return t}function kf(n,i,r,u,f,e,o,s,h,c){return(c=ai(c),typeof n!="string")?(t("Name is required when creating a product"),null):v.isStringOrNumber(i)?v.isStringOrNumber(r)?(u||(u=1),{Name:n,Sku:i,Price:r,Quantity:u,Brand:o,Variant:f,Category:e,Position:s,CouponCode:h,TotalAmount:u*r,Attributes:c}):(t("Price is required when creating a product, and must be a string or a number"),null):(t("SKU is required when creating a product, and must be a string or a number"),null)}function df(n,i,r,u){return v.isStringOrNumber(n)?{Id:n,Creative:i,Name:r,Position:u}:(t(p.PromotionIdRequired),null)}function gf(n,i){return typeof n!="string"?(t("Name is required when creating an impression."),null):i?{Name:n,Product:i}:(t("Product is required when creating an impression."),null)}function ne(n,i,r,u,f,e){return v.isStringOrNumber(n)?{Id:n,Affiliation:i,CouponCode:r,Revenue:u,Shipping:f,Tax:e}:(t(p.TransactionIdRequired),null)}function uu(n,i){f.length&&f.forEach(function(r){if(r.setUserAttribute&&r.userAttributeFilters&&!ri(r.userAttributeFilters,ot(n)))try{var u=r.setUserAttribute(n,i);u&&t(u)}catch(f){t(f)}})}function ki(n,t){if(t&&n)for(var i in n)if(n.hasOwnProperty(i)&&i.toLowerCase()===t.toLowerCase())return i;return null}function ai(n){var r,i;if(!n||!rt(n))return null;r={};for(i in n)n.hasOwnProperty(i)&&v.isValidAttributeValue(n[i])?r[i]=n[i]:t("The attribute key of "+i+" must be a string, number, boolean, or null.");return r}function re(){return kt}var or="jssdk.mparticle.com/v1/JS/",di="jssdks.mparticle.com/v1/JS/",ou=i&&i.forceHttps?"https://":n.location.protocol+"//",sr="1.16.0",bt=!0,su=/\+/g,ct={},s={},w=[],oi=!1,si=[],f=[],y,hi,ci,kt,ni,yt,gi=[],ut=null,nt,ft,ti={},vi,yi=!1,hr,ii=[],nr=!1,a={},b=[],tr=null,dt=null,li=null,cr=null,lr,hu="$MethodName",cu="LogLTVIncrease",lu="$Amount",u,o,st,g,i;Array.prototype.forEach||(Array.prototype.forEach=function(n,t){var u,i,r,f,e;if(this==null)throw new TypeError(" this is null or not defined");if(r=Object(this),f=r.length>>>0,typeof n!="function")throw new TypeError(n+" is not a function");for(arguments.length>1&&(u=t),i=0;i<f;)i in r&&(e=r[i],n.call(u,e,i,r)),i++});Array.prototype.map||(Array.prototype.map=function(n,t){var e,u,i,r,f,o,s;if(this===null)throw new TypeError(" this is null or not defined");if(r=Object(this),f=r.length>>>0,typeof n!="function")throw new TypeError(n+" is not a function");for(arguments.length>1&&(e=t),u=new Array(f),i=0;i<f;)i in r&&(o=r[i],s=n.call(e,o,i,r),u[i]=s),i++;return u});Array.prototype.filter||(Array.prototype.filter=function(n){"use strict";var i,f,r,e,t,u;if(this===void 0||this===null)throw new TypeError;if(i=Object(this),f=i.length>>>0,typeof n!="function")throw new TypeError;for(r=[],e=arguments.length>=2?arguments[1]:void 0,t=0;t<f;t++)t in i&&(u=i[t],n.call(e,u,t,i)&&r.push(u));return r});Array.isArray||(Array.prototype.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"});u={isLocalStorageAvailable:null,initializeStorage:function(){var e,r,t,f;this.isLocalStorageAvailable=u.determineLocalStorageAvailability();this.isLocalStorageAvailable?(r=this.getLocalStorage(),t=this.getCookie(),e=n.localStorage,i.useCookieStorage?(r?(f=t?lt(!1,r,JSON.parse(t)):r,e.removeItem(ht.LocalStorageNameV3)):t&&(f=JSON.parse(t)),this.storeDataInMemory(f)):t?(f=r?lt(!1,r,JSON.parse(t)):JSON.parse(t),this.storeDataInMemory(f),this.expireCookies(l.CookieNameV3)):this.storeDataInMemory(r)):this.storeDataInMemory(JSON.parse(this.getCookie()));this.update()},getCookieDomain:function(){if(l.CookieDomain)return l.CookieDomain;var n=this.getDomain(document,location.hostname);return n===""?"":"."+n},update:function(){if(i.useCookieStorage||!this.isLocalStorageAvailable){var f=new Date,e=l.CookieNameV3,o=this.convertInMemoryDataForCookie(),s=new Date(f.getTime()+l.CookieExpiration*864e5).toGMTString(),r,u=this.getCookieDomain();r=u===""?"":";domain="+u;t(h.CookieSet);n.document.cookie=encodeURIComponent(e)+"="+this.encodeCookies(o)+";expires="+s+";path=/"+r}this.setLocalStorage()},determineLocalStorageAvailability:function(){var t,i;try{return(t=n.localStorage).setItem("mparticle","test"),i=t.getItem("mparticle")==="test",t.removeItem("mparticle"),i&&t?!0:!1}catch(r){return!1}},convertInMemoryDataForCookie:function(){var n={sid:y,ie:bt,sa:ct,ua:s,ui:w,ss:ut,dt:yt,les:nt?nt.getTime():null,ssd:ft?ft.getTime():null,av:dt,cgid:ci,das:kt,csd:ti,mpid:ni};for(var t in n)n.hasOwnProperty(t)&&(!n[t]||typeof n[t]=="string"&&n[t].length===0||rt(n[t])&&Object.keys(n[t]).length===0||Array.isArray(n[t])&&n[t].length===0)&&delete n[t];return JSON.stringify(n)},convertInMemoryDataForLocalStorage:function(){var n={cp:b.length<=i.maxProducts?b:b.slice(0,i.maxProducts),pb:{}};for(var t in a)n.pb[t]=a[t].length>i.maxProducts?a[t].slice(0,i.maxProducts):a[t];return n.cp.length===0&&delete n.cp,Object.keys(n.pb).length===0&&delete n.pb,n},setLocalStorage:function(){var u=l.LocalStorageNameV3,r=this.convertInMemoryDataForLocalStorage();if(i.useCookieStorage||(r=lt(!0,{},r,JSON.parse(this.convertInMemoryDataForCookie()))),rt(r))try{n.localStorage.setItem(encodeURIComponent(u),this.encodeCookies(JSON.stringify(r)))}catch(f){t("Error with setting localStorage item.")}},getLocalStorage:function(){var u=l.LocalStorageNameV3,t=n.localStorage.getItem(encodeURIComponent(u)),r={},i;if(t){t=JSON.parse(this.decodeCookies(t));for(i in t)t.hasOwnProperty(i)&&(r[i]=t[i])}return Object.keys(r).length?r:null},storeDataInMemory:function(n){try{n?(y=n.sid||n.SessionId||y,bt=typeof n.ie!="undefined"?n.ie:n.IsEnabled||bt,ct=n.sa||n.SessionAttributes||ct,s=n.ua||n.UserAttributes||s,w=n.ui||n.UserIdentities||w,ut=n.ss||n.ServerSettings||ut,yt=n.dt||n.DeveloperToken||yt,ci=n.cgid||gt(),kt=n.das||null,ni=n.mpid||null,b=n.cp||b||[],a=n.pb||a||{},n.les?nt=new Date(n.les):n.LastEventSent&&(nt=new Date(n.LastEventSent)),ft=n.ssd?new Date(n.ssd):new Date,n.csd&&(ti=n.csd)):(ci=gt(),t(h.CookieNotFound))}catch(i){t(p.CookieParseError)}},retrieveDeviceId:function(){return kt?kt:this.parseDeviceId(ut)},parseDeviceId:function(n){try{var t={},i;return n&&n.uid&&n.uid.Value&&(n.uid.Value.split("&").forEach(function(n){i=n.split("=");t[i[0]]=i[1]}),t.g)?t.g:gt()}catch(r){return gt()}},expireCookies:function(n){var t=new Date,i,u,r;t.setTime(t.getTime()-864e5);i="; expires="+t.toUTCString();document.cookie=n+"="+i+"; path=/";r=this.getCookieDomain();u=r===""?"":";domain="+r;document.cookie=n+"="+i+"; path=/"+u},getCookie:function(){var f=n.document.cookie.split("; "),e=l.CookieNameV3,r,i,o,u,s,c;for(t(h.CookieSearch),i=0,o=f.length;i<o;i++)u=f[i].split("="),s=u.shift(),c=u.join("="),e&&e===s&&(r=this.decodeCookies(iu(c)));return r?(t(h.CookieFound),r):null},encodeCookies:function(n){n=u.convertUIFromArrayToObject(JSON.parse(n));for(var t in n)n.hasOwnProperty(t)&&(eu[t]?Object.keys(n[t]).length?n[t]=it.encode(JSON.stringify(n[t])):delete n[t]:t==="ie"&&(n[t]=n[t]?1:0));return u.replaceCommasWithPipes(u.replaceQuotesWithApostrophes(JSON.stringify(n)))},decodeCookies:function(n){var i,t,r;try{if(n=this.replacePipesWithCommas(this.replaceApostrophesWithQuotes(n)),i=[],n=JSON.parse(n),rt(n)&&Object.keys(n).length){for(t in n)if(n.hasOwnProperty(t))if(eu[t])if(t==="cp"&&Array.isArray(n[t])||t==="pb"&&rt(n[t]))continue;else n[t]=JSON.parse(it.decode(n[t]));else t==="ie"&&(n[t]=Boolean(n[t]));if(n.ui&&rt(n.ui)){for(r in n.ui)n.ui.hasOwnProperty(r)&&i.push({Identity:n.ui[r],Type:at(r)});n.ui=i.length?i:[]}}}catch(u){n={}}return JSON.stringify(n)},getDomain:function(n,t){for(var r,u="mptest=cookie",f=t.split("."),i=f.length-1;i>=0;i--)if(r=f.slice(i).join("."),n.cookie=u+";domain=."+r+";",n.cookie.indexOf(u)>-1)return n.cookie=u.split("=")[0]+"=;domain=."+r+";expires=Thu, 01 Jan 1970 00:00:01 GMT;",r;return""},migratePersistence:function(){this.migrateCookies();this.migrateLocalStorage()},migrateCookies:function(){function w(i,r){y=new Date;p=new Date(y.getTime()+l.CookieExpiration*864e5).toGMTString();s=u.getCookieDomain();c=s===""?"":";domain="+s;t(h.CookieSet);n.document.cookie=l.CookieNameV3+"="+i+";expires="+p+";path=/"+c;r&&u.expireCookies(r)}var a=n.document.cookie.split("; "),i,f,v,o,r,e,y,p,s,c;for(t(h.CookieSearch),f=0,v=a.length;f<v;f++)if(o=a[f].split("="),r=tu(o.shift()),e=tu(o.join("=")),i,l.CookieNameV3===r){e.indexOf('"')!==-1&&(i=u.replaceQuotesWithApostrophes(e),w(i));break}else if(l.CookieName===r||l.CookieNameV2===r){i=u.encodeCookies(iu(e));w(i,r);break}},migrateLocalStorage:function(){function o(i){try{n.localStorage.setItem(encodeURIComponent(l.LocalStorageNameV3),u.encodeCookies(i))}catch(r){t("Error with setting localStorage item.")}}var f=l.LocalStorageNameV3,r=l.LocalStorageName,e=n.localStorage.getItem(f),i;e||(i=JSON.parse(decodeURIComponent(n.localStorage.getItem(r))),rt(i)&&Object.keys(i).length&&o(JSON.stringify(i),r),n.localStorage.removeItem(encodeURIComponent(r)))},replaceCommasWithPipes:function(n){return n.replace(/,/g,"|")},replacePipesWithCommas:function(n){return n.replace(/\|/g,",")},replaceApostrophesWithQuotes:function(n){return n.replace(/\'/g,'"')},replaceQuotesWithApostrophes:function(n){return n.replace(/\"/g,"'")},convertUIFromArrayToObject:function(n){return n&&n.ui&&Array.isArray(n.ui)&&(n.ui=n.ui.reduce(function(n,t){return t.hasOwnProperty("Identity")&&v.isStringOrNumber(t.Identity)&&(n[t.Type]=t.Identity),n},{})),n}};var it={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(i){try{if(n.btoa&&n.atob)return n.btoa(i)}catch(r){t("Error encoding cookie values into Base64:"+r)}return it._encode(i)},_encode:function(n){var f="",e,t,i,s,h,o,r,u=0;for(n=fu.encode(n);u<n.length;)e=n.charCodeAt(u++),t=n.charCodeAt(u++),i=n.charCodeAt(u++),s=e>>2,h=(e&3)<<4|t>>4,o=(t&15)<<2|i>>6,r=i&63,isNaN(t)?o=r=64:isNaN(i)&&(r=64),f=f+it._keyStr.charAt(s)+it._keyStr.charAt(h)+it._keyStr.charAt(o)+it._keyStr.charAt(r);return f},decode:function(t){try{if(n.btoa&&n.atob)return decodeURIComponent(escape(n.atob(t)))}catch(i){}return it._decode(t)},_decode:function(n){var t="",e,o,s,h,u,r,f,i=0;for(n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");i<n.length;)h=it._keyStr.indexOf(n.charAt(i++)),u=it._keyStr.indexOf(n.charAt(i++)),r=it._keyStr.indexOf(n.charAt(i++)),f=it._keyStr.indexOf(n.charAt(i++)),e=h<<2|u>>4,o=(u&15)<<4|r>>2,s=(r&3)<<6|f,t=t+String.fromCharCode(e),r!==64&&(t=t+String.fromCharCode(o)),f!==64&&(t=t+String.fromCharCode(s));return fu.decode(t)}},fu={encode:function(n){for(var t,i="",r=0;r<n.length;r++)t=n.charCodeAt(r),t<128?i+=String.fromCharCode(t):t>127&&t<2048?(i+=String.fromCharCode(t>>6|192),i+=String.fromCharCode(t&63|128)):(i+=String.fromCharCode(t>>12|224),i+=String.fromCharCode(t>>6&63|128),i+=String.fromCharCode(t&63|128));return i},decode:function(n){for(var r="",t=0,i=0,u=0,f=0;t<n.length;)i=n.charCodeAt(t),i<128?(r+=String.fromCharCode(i),t++):i>191&&i<224?(u=n.charCodeAt(t+1),r+=String.fromCharCode((i&31)<<6|u&63),t+=2):(u=n.charCodeAt(t+1),f=n.charCodeAt(t+2),r+=String.fromCharCode((i&15)<<12|(u&63)<<6|f&63),t+=3);return r}},e={SessionStart:1,SessionEnd:2,PageView:3,PageEvent:4,CrashReport:5,OptOut:6,AppStateTransition:10,Profile:14,Commerce:16},c={Unknown:0,Navigation:1,Location:2,Search:3,Transaction:4,UserContent:5,UserPreference:6,Social:7,Other:8},te={Logout:3},ie={AppInit:1};c.getName=function(n){switch(n){case c.Navigation:return"Navigation";case c.Location:return"Location";case c.Search:return"Search";case c.Transaction:return"Transaction";case c.UserContent:return"User Content";case c.UserPreference:return"User Preference";case c.Social:return"Social";case o.ProductAddToCart:return"Product Added to Cart";case o.ProductAddToWishlist:return"Product Added to Wishlist";case o.ProductCheckout:return"Product Checkout";case o.ProductCheckoutOption:return"Product Checkout Options";case o.ProductClick:return"Product Click";case o.ProductImpression:return"Product Impression";case o.ProductPurchase:return"Product Purchased";case o.ProductRefund:return"Product Refunded";case o.ProductRemoveFromCart:return"Product Removed From Cart";case o.ProductRemoveFromWishlist:return"Product Removed from Wishlist";case o.ProductViewDetail:return"Product View Details";case o.PromotionClick:return"Promotion Click";case o.PromotionView:return"Promotion View";default:return"Other"}};o={ProductAddToCart:10,ProductRemoveFromCart:11,ProductCheckout:12,ProductCheckoutOption:13,ProductClick:14,ProductViewDetail:15,ProductPurchase:16,ProductRefund:17,PromotionView:18,PromotionClick:19,ProductAddToWishlist:20,ProductRemoveFromWishlist:21,ProductImpression:22};st={Other:0,CustomerId:1,Facebook:2,Twitter:3,Google:4,Microsoft:5,Yahoo:6,Email:7,Alias:8,FacebookCustomAudienceId:9};st.isValid=function(n){if(typeof n=="number")for(var t in st)if(st.hasOwnProperty(t)&&st[t]===n)return!0;return!1};st.getName=function(t){switch(t){case n.mParticle.IdentityType.CustomerId:return"Customer ID";case n.mParticle.IdentityType.Facebook:return"Facebook ID";case n.mParticle.IdentityType.Twitter:return"Twitter ID";case n.mParticle.IdentityType.Google:return"Google ID";case n.mParticle.IdentityType.Microsoft:return"Microsoft ID";case n.mParticle.IdentityType.Yahoo:return"Yahoo ID";case n.mParticle.IdentityType.Email:return"Email";case n.mParticle.IdentityType.Alias:return"Alias ID";case n.mParticle.IdentityType.FacebookCustomAudienceId:return"Facebook App User ID";default:return"Other ID"}};var ht={LocalStorageName:"mprtcl-api",LocalStorageNameV3:"mprtcl-v3",CookieName:"mprtcl-api",CookieNameV2:"mprtcl-v2",CookieNameV3:"mprtcl-v3",CookieDomain:null,Debug:!1,CookieExpiration:365,Verbose:!1,IncludeReferrer:!0,IncludeGoogleAdwords:!0,Timeout:300,SessionTimeout:30,Sandbox:!1,Version:null,MaxProducts:20},l={},p={NoToken:"A token must be specified.",EventNameInvalidType:"Event name must be a valid string value.",EventDataInvalidType:"Event data must be a valid object hash.",LoggingDisabled:"Event logging is currently disabled.",CookieParseError:"Could not parse cookie",EventEmpty:"Event object is null or undefined, cancelling send",NoEventType:"Event type must be specified.",TransactionIdRequired:"Transaction ID is required",TransactionRequired:"A transaction attributes object is required",PromotionIdRequired:"Promotion ID is required",BadAttribute:"Attribute value cannot be object or array",BadKey:"Key value cannot be object or array",BadLogPurchase:"Transaction attributes and a product are both required to log a purchase, https://docs.mparticle.com/?javascript#measuring-transactions"},h={CookieSearch:"Searching for cookie",CookieFound:"Cookie found, parsing values",CookieNotFound:"Cookies not found",CookieSet:"Setting cookie",CookieSync:"Performing cookie sync",SendBegin:"Starting to send event",SendWindowsPhone:"Sending event to Windows Phone container",SendIOS:"Calling iOS path: ",SendAndroid:"Calling Android JS interface method: ",SendHttp:"Sending event to mParticle HTTP service",StartingNewSession:"Starting new Session",StartingLogEvent:"Starting to log event",StartingLogOptOut:"Starting to log user opt in/out",StartingEndSession:"Starting to end session",StartingInitialization:"Starting to initialize",StartingLogCommerceEvent:"Starting to log commerce event",LoadingConfig:"Loading configuration options",AbandonLogEvent:"Cannot log event, logging disabled or developer token not set",AbandonStartSession:"Cannot start session, logging disabled or developer token not set",AbandonEndSession:"Cannot end session, logging disabled or developer token not set",NoSessionToEnd:"Cannot end session, no active session found"},d={LogEvent:"logEvent",SetUserIdentity:"setUserIdentity",RemoveUserIdentity:"removeUserIdentity",SetUserTag:"setUserTag",RemoveUserTag:"removeUserTag",SetUserAttribute:"setUserAttribute",RemoveUserAttribute:"removeUserAttribute",SetSessionAttribute:"setSessionAttribute",AddToProductBag:"addToProductBag",RemoveFromProductBag:"removeFromProductBag",ClearProductBag:"clearProductBag",AddToCart:"addToCart",RemoveFromCart:"removeFromCart",ClearCart:"clearCart",LogOut:"logOut",SetUserAttributeList:"setUserAttributeList",RemoveAllUserAttributes:"removeAllUserAttributes",GetUserAttributesLists:"getUserAttributesLists",GetAllUserAttributes:"getAllUserAttributes"},r={Unknown:0,AddToCart:1,RemoveFromCart:2,Checkout:3,CheckoutOption:4,Click:5,ViewDetail:6,Purchase:7,Refund:8,AddToWishlist:9,RemoveFromWishlist:10},eu={ss:1,ui:1,ua:1,sa:1,cp:1,pb:1,csd:1};r.getName=function(n){switch(n){case r.AddToCart:return"Add to Cart";case r.RemoveFromCart:return"Remove from Cart";case r.Checkout:return"Checkout";case r.CheckoutOption:return"Checkout Option";case r.Click:return"Click";case r.ViewDetail:return"View Detail";case r.Purchase:return"Purchase";case r.Refund:return"Refund";case r.AddToWishlist:return"Add to Wishlist";case r.RemoveFromWishlist:return"Remove from Wishlist";default:return"Unknown"}};r.getExpansionName=function(n){switch(n){case r.AddToCart:return"AddToCart";case r.RemoveFromCart:return"RemoveFromCart";case r.Checkout:return"Checkout";case r.CheckoutOption:return"CheckoutOption";case r.Click:return"Click";case r.ViewDetail:return"ViewDetail";case r.Purchase:return"Purchase";case r.Refund:return"Refund";case r.AddToWishlist:return"AddToWishlist";case r.RemoveFromWishlist:return"RemoveFromWishlist";default:return"Unknown"}};g={Unknown:0,PromotionView:1,PromotionClick:2};g.getName=function(n){switch(n){case g.PromotionView:return"Promotion View";case g.PromotionClick:return"Promotion Click";default:return"Unknown"}};g.getExpansionName=function(n){switch(n){case g.PromotionView:return"view";case g.PromotionClick:return"click";default:return"Unknown"}};var vt={attemptCookieSync:function(n,t){var i,u,f,e,r;t&&!pt()&&gi.forEach(function(o){if(i={moduleId:o.moduleId,frequencyCap:o.frequencyCap,pixelUrl:vt.replaceAmp(o.pixelUrl),redirectUrl:o.redirectUrl?vt.replaceAmp(o.redirectUrl):null},f=vt.replaceMPID(i.pixelUrl,t),e=i.redirectUrl?vt.replaceMPID(i.redirectUrl,t):"",r=f+encodeURIComponent(e),n&&n!==t){vt.performCookieSync(r,i.moduleId);return}u=ti[i.moduleId.toString()]?ti[i.moduleId.toString()]:null;u?(new Date).getTime()>new Date(u).getTime()+i.frequencyCap*864e5&&vt.performCookieSync(r,i.moduleId):vt.performCookieSync(r,i.moduleId)})},performCookieSync:function(n,i){var r=document.createElement("img");t(h.CookieSync);r.src=n;ti[i.toString()]=(new Date).getTime();u.update()},replaceMPID:function(n,t){return n.replace("%%mpid%%",t)},replaceAmp:function(n){return n.replace(/&amp;/g,"&")}},v={isValidAttributeValue:function(n){return n!==undefined&&!rt(n)&&!Array.isArray(n)},isValidKeyValue:function(n){return Boolean(n&&!rt(n)&&!Array.isArray(n))},isStringOrNumber:function(n){return typeof n=="string"||typeof n=="number"}},er={initialize:function(){if(y){var n=l.SessionTimeout*6e4;new Date>new Date(nt.getTime()+n)&&(this.endSession(),this.startNewSession())}else this.startNewSession()},getSession:function(){return y},startNewSession:function(){if(t(h.StartingNewSession),tt()){if(y=gt(),!ft){var n=new Date;ft=n;nt=n}i.sessionManager.setSessionTimer();et(e.SessionStart)}else t(h.AbandonStartSession)},endSession:function(n){var r,i,f,o;if(t(h.StartingEndSession),n)et(e.SessionEnd),y=null,nt=null,ft=null,ct={},u.update();else if(tt()){if(i=u.getCookie()||u.getLocalStorage(),!i.sid){t(h.NoSessionToEnd);return}i.sid&&y!==i.sid&&(y=i.sid);i.les&&(r=l.SessionTimeout*6e4,o=(new Date).getTime(),f=o-i.les,f<r?this.setSessionTimer():(et(e.SessionEnd),y=null,nt=null,ft=null,ct={},u.update()))}else t(h.AbandonEndSession)},setSessionTimer:function(){var t=l.SessionTimeout*6e4;lr=n.setTimeout(function(){i.sessionManager.endSession()},t)},resetSessionTimer:function(){y||this.startNewSession();this.clearSessionTimeout();this.setSessionTimer()},clearSessionTimeout:function(){clearTimeout(lr)}};i={useNativeSdk:!0,isIOS:!1,isDebug:!1,isSandbox:!1,useCookieStorage:!1,maxProducts:ht.MaxProducts,getDeviceId:re,generateHash:ot,sessionManager:er,cookieSyncManager:vt,persistence:u,Validators:v,IdentityType:st,EventType:c,CommerceEventType:o,PromotionType:g,ProductActionType:r,init:function(){var n;t(h.StartingInitialization);fr({});u.migratePersistence();hi=u.getCookie()===null&&u.getLocalStorage()===null?!0:!1;u.initializeStorage();kt=u.retrieveDeviceId();arguments&&arguments.length&&(typeof arguments[0]=="string"&&(yt=arguments[0],yu()),typeof arguments[0]=="object"?n=arguments[0]:arguments.length>1&&typeof arguments[1]=="object"&&(n=arguments[1]),n&&fr(n));i.sessionManager.initialize();ii&&ii.length&&(ii.forEach(function(n){typeof n=="function"&&n()}),ii=[]);yf();u.update();nr=!0},reset:function(){bt=!0;hi=null;yr();yt=null;y=null;nt=null;ft=null;li=null;dt=null;ct={};s={};w=[];oi=!1;ti={};f=[];si=[];gi=[];a={};b=[];ut=null;fr({});u.expireCookies(ht.CookieName);u.expireCookies(ht.CookieNameV2);u.expireCookies(ht.CookieNameV3);u.isLocalStorageAvailable&&(localStorage.removeItem(ht.LocalStorageName),localStorage.removeItem(ht.LocalStorageNameV3));i.sessionManager.resetSessionTimer();nr=!1},ready:function(n){nr&&typeof n=="function"?n():ii.push(n)},getVersion:function(){return sr},setAppVersion:function(n){dt=n;u.update()},getAppName:function(){return li},setAppName:function(n){li=n},getAppVersion:function(){return dt},stopTrackingLocation:function(){i.sessionManager.resetSessionTimer();yr()},startTrackingLocation:function(){i.sessionManager.resetSessionTimer();wu()},setPosition:function(n,r){i.sessionManager.resetSessionTimer();typeof n=="number"&&typeof r=="number"?vi={lat:n,lng:r}:t("Position latitude and/or longitude are invalid")},setUserIdentity:function(n,r){var e,s=!1,o;if(i.sessionManager.resetSessionTimer(),tt())if(st.isValid(r)){if(n===null||n===undefined)return i.removeUserIdentity(n,r);v.isStringOrNumber(n)?(o=!1,w.forEach(function(t){t.Type===r&&t.Identity===n&&(o=!0)}),o||(oi=!0,s=!0),w=w.filter(function(n){return n.Type!==r}),e={Identity:n,Type:r},w.push(e),k(d.SetUserIdentity,JSON.stringify(e))||f.length&&f.forEach(function(i){if(i.setUserIdentity&&(!i.userIdentityFilters||!ri(i.userIdentityFilters,r))){var u=i.setUserIdentity(n,r);u&&t(u)}}),u.update()):t("User identities passed to setUserIdentity must be strings or numbers")}else t("IdentityType is not valid. Please ensure you are using a valid IdentityType from http://docs.mparticle.com/#user-identity");return s},getUserIdentity:function(n){i.sessionManager.resetSessionTimer();var t=null;return w.forEach(function(i){i.Identity===n&&(t=i)}),t},removeUserIdentity:function(n,r){i.sessionManager.resetSessionTimer();var f=null,e=!1;return n&&(f=w.filter(function(t){return t.Identity!==n})),r&&st.isValid(r)?f=w.filter(function(n){return n.Type!==r}):t("IdentityType is not valid. Please ensure you are using a valid IdentityType from http://docs.mparticle.com/#user-identity"),f&&f.length!==w.length&&(w=f,oi=!0,e=!0),k(d.RemoveUserIdentity,n),u.update(),e},startNewSession:function(){er.startNewSession()},endSession:function(){er.endSession(!0)},logEvent:function(n,r,u,f){if(i.sessionManager.resetSessionTimer(),typeof n!="string"){t(p.EventNameInvalidType);return}if(r||(r=c.Unknown),!bf(r)){t("Invalid event type: "+r+", must be one of: \n"+JSON.stringify(c));return}if(!tt()){t(p.LoggingDisabled);return}et(e.PageEvent,n,u,r,f)},logError:function(n){(i.sessionManager.resetSessionTimer(),n)&&(typeof n=="string"&&(n={message:n}),et(e.CrashReport,n.name?n.name:"Error",{m:n.message?n.message:n,s:"Error",t:n.stack},c.Other))},logLink:function(n,t,r,u){i.sessionManager.resetSessionTimer();ru("click",n,t,u,r)},logForm:function(n,t,r,u){i.sessionManager.resetSessionTimer();ru("submit",n,t,u,r)},logPageView:function(){i.sessionManager.resetSessionTimer();var t=null,r=null,u=null;tt()&&(arguments.length<=1?(t=n.location.pathname,r={hostname:n.location.hostname,title:n.document.title},arguments.length===1&&(u=arguments[0])):arguments.length>1&&(t=arguments[0],r=arguments[1],arguments.length===3&&(u=arguments[2])),et(e.PageView,t,r,c.Unknown,u))},eCommerce:{ProductBags:{add:function(n,r){if(!v.isStringOrNumber(n)){t("ProductBagName is required and must be a string or number");return}i.sessionManager.resetSessionTimer();a[n]||(a[n]=[]);a[n].push(r);a[n].length>i.maxProducts&&t(n+" contains "+a[n].length+" items. Only mParticle.maxProducts = "+i.maxProducts+" can currently be saved in cookies.");u.update();k(d.AddToProductBag,JSON.stringify(r))},remove:function(n,t){i.sessionManager.resetSessionTimer();var r=-1;a[n]&&(a[n].forEach(function(n,i){n.sku===t.sku&&(r=i)}),r>-1&&a[n].splice(r,1),u.update());k(d.RemoveFromProductBag,JSON.stringify(t))},clear:function(n){i.sessionManager.resetSessionTimer();a[n]=[];u.update();k(d.ClearProductBag,n)}},Cart:{add:function(n,f){i.sessionManager.resetSessionTimer();var e;n.Attributes=ai(n.Attributes);e=Array.isArray(n)?n.slice():[n];b=b.concat(e);b.length>i.maxProducts&&t("The cart contains "+b.length+" items. Only mParticle.maxProducts = "+i.maxProducts+" can currently be saved in cookies.");pt()?k(d.AddToCart,JSON.stringify(e)):f===!0&&ur(r.AddToCart,e);u.update()},remove:function(n,t){i.sessionManager.resetSessionTimer();var f=-1,e=null;b&&(b.forEach(function(t,i){t.Sku===n.Sku&&(f=i,e=t)}),f>-1&&(b.splice(f,1),pt()?k(d.RemoveFromCart,JSON.stringify(e)):t===!0&&ur(r.RemoveFromCart,e)));u.update()},clear:function(){i.sessionManager.resetSessionTimer();b=[];k(d.ClearCart);u.update()}},setCurrencyCode:function(n){if(typeof n!="string"){t("Code must be a string");return}i.sessionManager.resetSessionTimer();tr=n},createProduct:function(n,t,r,u,f,e,o,s,h,c){return i.sessionManager.resetSessionTimer(),kf(n,t,r,u,f,e,o,s,h,c)},createPromotion:function(n,t,r,u){return i.sessionManager.resetSessionTimer(),df(n,t,r,u)},createImpression:function(n,t){return i.sessionManager.resetSessionTimer(),gf(n,t)},createTransactionAttributes:function(n,t,r,u,f,e){return i.sessionManager.resetSessionTimer(),ne(n,t,r,u,f,e)},logCheckout:function(n,t,r){i.sessionManager.resetSessionTimer();sf(n,t,r)},logProductAction:function(n,t,r){i.sessionManager.resetSessionTimer();ur(n,t,r)},logPurchase:function(n,r,u,f){if(!n||!r){t(p.BadLogPurchase);return}i.sessionManager.resetSessionTimer();hf(n,r,f);u===!0&&i.eCommerce.Cart.clear()},logPromotion:function(n,t,r){i.sessionManager.resetSessionTimer();lf(n,t,r)},logImpression:function(n,t){i.sessionManager.resetSessionTimer();af(n,t)},logRefund:function(n,t,r,u){i.sessionManager.resetSessionTimer();cf(n,t,u);r===!0&&i.eCommerce.Cart.clear()},expandCommerceEvent:function(n){return i.sessionManager.resetSessionTimer(),of(n)}},logEcommerceTransaction:function(n,t,r,u,f,o,s,h,l,a,v){i.sessionManager.resetSessionTimer();var y={};y.$MethodName="LogEcommerceTransaction";y.ProductName=n||"";y.ProductSKU=t||"";y.ProductUnitPrice=r||0;y.ProductQuantity=u||0;y.ProductCategory=f||"";y.RevenueAmount=o||0;y.TaxAmount=s||0;y.ShippingAmount=h||0;y.CurrencyCode=l||"USD";y.TransactionAffiliation=a||"";y.TransactionID=v||gt();et(e.PageEvent,"Ecommerce",y,c.Transaction)},logLTVIncrease:function(n,r,u){if(i.sessionManager.resetSessionTimer(),typeof n!="number"){t("A valid amount must be passed to logLTVIncrease.");return}u||(u={});u[lu]=n;u[hu]=cu;et(e.PageEvent,r||"Increase LTV",u,c.Transaction)},setUserTag:function(r){if(i.sessionManager.resetSessionTimer(),!v.isValidKeyValue(r)){t(p.BadKey);return}n.mParticle.setUserAttribute(r,null)},removeUserTag:function(r){if(i.sessionManager.resetSessionTimer(),!v.isValidKeyValue(r)){t(p.BadKey);return}n.mParticle.removeUserAttribute(r)},setUserAttribute:function(n,r){if(i.sessionManager.resetSessionTimer(),tt()){if(!v.isValidAttributeValue(r)){t(p.BadAttribute);return}if(!v.isValidKeyValue(n)){t(p.BadKey);return}var f=ki(s,n);f&&delete s[f];s[n]=r;u.update();k(d.SetUserAttribute,JSON.stringify({key:n,value:r}))||uu(n,r)}},removeUserAttribute:function(n){if(i.sessionManager.resetSessionTimer(),!v.isValidKeyValue(n)){t(p.BadKey);return}var r=ki(s,n);r&&(n=r);delete s[n];k(d.RemoveUserAttribute,JSON.stringify({key:n,value:null}))||ir("removeUserAttribute",n);u.update()},setUserAttributeList:function(n,r){if(i.sessionManager.resetSessionTimer(),!v.isValidKeyValue(n)){t(p.BadKey);return}if(Array.isArray(r)){var f=r.slice(),e=ki(s,n);e&&delete s[e];s[n]=f;u.update();k(d.SetUserAttributeList,JSON.stringify({key:n,value:f}))||uu(n,f)}},removeAllUserAttributes:function(){if(i.sessionManager.resetSessionTimer(),!k(d.RemoveAllUserAttributes)&&s)for(var n in s)s.hasOwnProperty(n)&&ir("removeUserAttribute",n);s={};u.update()},getUserAttributesLists:function(){var t={};for(var n in s)s.hasOwnProperty(n)&&Array.isArray(s[n])&&(t[n]=s[n].slice());return t},getAllUserAttributes:function(){var t={},n;if(s)for(n in s)s.hasOwnProperty(n)&&(t[n]=Array.isArray(s[n])?s[n].slice():s[n]);return t},setSessionAttribute:function(n,r){if(i.sessionManager.resetSessionTimer(),tt()){if(!v.isValidAttributeValue(r)){t(p.BadAttribute);return}if(!v.isValidKeyValue(n)){t(p.BadKey);return}var f=ki(ct,n);f&&(n=f);ct[n]=r;u.update();k(d.SetSessionAttribute,JSON.stringify({key:n,value:r}))||ir("setSessionAttribute",[n,r])}},setOptOut:function(n){i.sessionManager.resetSessionTimer();bt=!n;vf();u.update();f.length&&f.forEach(function(i){if(i.setOptOut){var r=i.setOptOut(n);r&&t(r)}})},logOut:function(){i.sessionManager.resetSessionTimer();var n;tt()&&(k(d.LogOut)||(n=pf(),f.length&&f.forEach(function(t){t.logOut&&t.logOut(n)})))},addForwarder:function(n){si.push(n)},configureForwarder:function(){for(var t=null,n=null,n=arguments.length===1?arguments[0]:{name:arguments[0],settings:arguments[1],eventNameFilters:arguments[2],eventTypeFilters:arguments[3],attributeFilters:arguments[4],screenNameFilters:arguments[5],pageViewAttributeFilters:arguments[6],userIdentityFilters:arguments[7],userAttributeFilters:arguments[8],moduleId:arguments[9],isSandbox:arguments[10],hasSandbox:arguments[11],isVisible:arguments[12],filteringEventAttributeValue:null},r=0;r<si.length;r++)if(si[r].name===n.name&&(n.isDebug===i.isSandbox||n.isSandbox===i.isSandbox)){t=new si[r].constructor;t.id=n.moduleId;t.isSandbox=n.isDebug||n.isSandbox;t.hasSandbox=n.hasDebugString==="true";t.isVisible=n.isVisible;t.settings=n.settings;t.eventNameFilters=n.eventNameFilters;t.eventTypeFilters=n.eventTypeFilters;t.attributeFilters=n.attributeFilters;t.screenNameFilters=n.screenNameFilters;t.screenNameFilters=n.screenNameFilters;t.pageViewAttributeFilters=n.pageViewAttributeFilters;t.userIdentityFilters=n.userIdentityFilters;t.userAttributeFilters=n.userAttributeFilters;t.filteringEventAttributeValue=n.filteringEventAttributeValue;t.filteringUserAttributeValue=n.filteringUserAttributeValue;f.push(t);break}},configurePixel:function(n){(n.isDebug===i.isSandbox||n.isProduction!==i.isSandbox)&&gi.push(n)}};n.mParticle&&n.mParticle.config&&(n.mParticle.config.serviceUrl&&(or=n.mParticle.config.serviceUrl),n.mParticle.config.secureServiceUrl&&(di=n.mParticle.config.secureServiceUrl),n.mParticle.config.rq&&(ii=n.mParticle.config.rq),n.mParticle.config.hasOwnProperty("isDebug")&&(i.isDebug=n.mParticle.config.isDebug),n.mParticle.config.hasOwnProperty("isSandbox")&&(i.isSandbox=n.mParticle.config.isSandbox),n.mParticle.config.hasOwnProperty("useNativeSdk")&&(i.useNativeSdk=n.mParticle.config.useNativeSdk),n.mParticle.config.hasOwnProperty("useCookieStorage")&&(i.useCookieStorage=n.mParticle.config.useCookieStorage),n.mParticle.config.hasOwnProperty("maxProducts")&&(i.maxProducts=n.mParticle.config.maxProducts),n.mParticle.config.hasOwnProperty("appName")&&(li=n.mParticle.config.appName),n.mParticle.config.hasOwnProperty("appVersion")&&(dt=n.mParticle.config.appVersion),n.mParticle.config.hasOwnProperty("sessionTimeout")&&(l.SessionTimeout=n.mParticle.config.sessionTimeout),n.mParticle.config.hasOwnProperty("forceHttps")&&(i.forceHttps=n.mParticle.config.forceHttps),n.mParticle.config.hasOwnProperty("customFlags")&&(cr=n.mParticle.config.customFlags));n.mParticle=i})(window) ;

(function(n){var t="Amplitude",i={SessionStart:1,SessionEnd:2,PageView:3,PageEvent:4,CrashReport:5,OptOut:6,Commerce:16},r=function(){function u(){return s?amplitude.getInstance():amplitude.getInstance(r.instanceName)}function l(n){return mParticle.IdentityType.getName(n)}function a(r){var u=!1;if(f)try{return r.EventDataType===i.PageView?(u=!0,w(r)):r.EventDataType===i.Commerce?u=k(r):r.EventDataType===i.PageEvent&&(u=!0,r.EventCategory===n.mParticle.EventType.Transaction?b(r):c(r)),u&&e&&e(o,r),"Successfully sent to "+t}catch(s){return"Failed to send to: "+t+" "+s}return"Can't send to forwarder "+t+", not initialized"}function v(i,r){if(f)r===n.mParticle.IdentityType.CustomerId?u().setUserId(i):h(l(r),i);else return"Can't call setUserIdentity on forwarder "+t+", not initialized"}function y(n){if(f){if(r.allowUnsetUserAttributes&&r.allowUnsetUserAttributes==="True")try{var i=(new amplitude.Identify).unset(n);return u().identify(i),"Successfully unset Amplitude user property: "+n}catch(e){return"Failed to call unset on "+t+" "+e}}else return"Can't call removeUserAttribute on forwarder "+t+", not initialized"}function h(n,i){if(f)try{var r={};return r[n]=i,u().setUserProperties(r),"Successfully called setUserProperties API on "+t}catch(e){return"Failed to call SET setUserProperties on "+t+" "+e}else return"Can't call setUserAttribute on forwarder "+t+", not initialized"}function p(n){if(f)u().setOptOut(n);else return"Can't call setOptOut on forwarder "+t+", not initialized"}function w(n){n.EventAttributes?u().logEvent("Viewed "+n.EventName,n.EventAttributes):u().logEvent("Viewed "+n.EventName)}function c(n){n.EventAttributes?u().logEvent(n.EventName,n.EventAttributes):u().logEvent(n.EventName)}function b(n){if(!n.EventAttributes||!n.EventAttributes.$MethodName||!1){c(n);return}u().logRevenue(n.EventAttributes.RevenueAmount,n.EventAttributes.ProductQuantity,n.EventAttributes.ProductSKU.toString())}function k(n){if(n.ProductAction){var t=n.ProductAction.ProductActionType===mParticle.ProductActionType.Refund,i=n.ProductAction.ProductActionType===mParticle.ProductActionType.Purchase||t,r=mParticle.eCommerce.expandCommerceEvent(n);return r.forEach(function(n){var f={},r,e,o;for(r in n.EventAttributes)r!=="Total Amount"&&r!=="Total Product Amount"&&(f[r]=n.EventAttributes[r]);i&&n.EventName.indexOf("Total")>-1?(e=(n.EventAttributes["Total Amount"]||0)*(t?-1:1),o=(new amplitude.Revenue).setPrice(e).setEventProperties(f),u().logRevenueV2(o)):u().logEvent(n.EventName,f)}),!0}return!1}function d(i,o,h){var c;r=i;e=o;isTesting=h;try{return n.amplitude||h!==!0&&function(n,t){function a(n,t){n.prototype[t]=function(){return this._q.push([t].concat(Array.prototype.slice.call(arguments,0))),this}}function v(n){function i(t){n[t]=function(){n._q.push([t].concat(Array.prototype.slice.call(arguments,0)))}}for(var t=0;t<l.length;t++)i(l[t])}var i=n.amplitude||{_q:[],_iq:{}},r=t.createElement("script"),e,o,s,u,h,c,f,l;for(r.type="text/javascript",r.async=!0,r.src="https://cdn.amplitude.com/libs/amplitude-4.2.1-min.gz.js",r.onload=function(){n.amplitude.runQueuedFunctions?n.amplitude.runQueuedFunctions():console.log("[Amplitude] Error: could not load SDK")},e=t.getElementsByTagName("script")[0],e.parentNode.insertBefore(r,e),o=function(){return this._q=[],this},s=["add","append","clearAll","prepend","set","setOnce","unset"],u=0;u<s.length;u++)a(o,s[u]);for(i.Identify=o,h=function(){return this._q=[],this},c=["setProductId","setQuantity","setPrice","setRevenueType","setEventProperties"],f=0;f<c.length;f++)a(h,c[f]);i.Revenue=h;l=["init","logEvent","logRevenue","setUserId","setUserProperties","setOptOut","setVersionName","setDomain","setDeviceId","setGlobalUserProperties","identify","clearUserProperties","setGroup","logRevenueV2","regenerateDeviceId","logEventWithTimestamp","logEventWithGroups","setSessionId","resetSessionId"];v(i);i.getInstance=function(n){return n=(!n||n.length===0?"$default_instance":n).toLowerCase(),i._iq.hasOwnProperty(n)||(i._iq[n]={_q:[]},v(i._iq[n])),i._iq[n]};n.amplitude=i}(n,document),c={},typeof n.AmplitudeInitSettings=="object"&&n.AmplitudeInitSettings!==null&&(c=n.AmplitudeInitSettings),r.saveEvents&&(c.saveEvents=r.saveEvents==="True"),r.savedMaxCount&&(c.savedMaxCount=parseInt(r.savedMaxCount,10)),r.uploadBatchSize&&(c.uploadBatchSize=parseInt(r.uploadBatchSize,10)),r.includeUtm&&(c.includeUtm=r.includeUtm==="True"),r.includeReferrer&&(c.includeReferrer=r.includeReferrer==="True"),r.forceHttps&&(c.forceHttps=r.forceHttps==="True"),s=!r.instanceName||r.instanceName==="default",u().init(r.apiKey,null,c),f=!0,"Successfully initialized: "+t}catch(l){return"Failed to initialize: "+t}}var o=this,f=!1,r,e,s;o.name=t;this.init=d;this.process=a;this.setUserIdentity=v;this.setUserAttribute=h;this.setOptOut=p;this.removeUserAttribute=y};n&&n.mParticle&&n.mParticle.addForwarder&&n.mParticle.addForwarder({name:t,constructor:r})})(window) ;


    ;window.mParticle.configureForwarder({"name":"Amplitude","moduleId":53,"isDebug":false,"isVisible":true,"isDebugString":"false","hasDebugString":"true","settings":{"apiKey":"08a05390a1dde922e826311dcace06da","userIdentification":"email","allowUnsetUserAttributes":"True","prefixAttributionWithSource":"True","instanceName":"default","includeEmailAsUserProperty":"False"},"screenNameFilters":[],"screenAttributeFilters":[],"userIdentityFilters":[],"userAttributeFilters":[],"eventNameFilters":[],"eventTypeFilters":[],"attributeFilters":[],"githubPath":null,"filteringEventAttributeValue":null,"filteringUserAttributeValue":null,"filteringConsentRuleValues":null,"consentRegulationFilters":[],"consentRegulationPurposeFilters":[],"messageTypeFilters":[],"messageTypeStateFilters":[],"eventSubscriptionId":25161});

if (window.mParticle.hasOwnProperty('configurePixel')) {

}

delete window.mParticle.addForwarder;
delete window.mParticle.configureForwarder;
if (window.mParticle.hasOwnProperty('configurePixel')) {
    delete window.mParticle.configurePixel;
}

mParticle.init('d53094f9018e7a478979ff830a8e61f1');